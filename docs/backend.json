{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the user account was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "createdAt"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task or meeting in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Task entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Task)"
        },
        "title": {
          "type": "string",
          "description": "The title of the task."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the task."
        },
        "isCompleted": {
          "type": "boolean",
          "description": "A boolean to track the task's status."
        },
        "dueDate": {
          "type": "string",
          "description": "Timestamp for the task's due date.",
          "format": "date-time"
        },
        "startTime": {
          "type": "string",
          "description": "Timestamp for when the task is scheduled to begin.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "Timestamp for when the task is scheduled to end.",
          "format": "date-time"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the task was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of the last modification.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "isCompleted",
        "createdAt",
        "updatedAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles, keyed by the Firebase Authentication UID.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores tasks owned by a specific user.  The 'userId' path segment ensures only the authenticated user can access their own tasks.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the task owner."
            },
            {
              "name": "taskId",
              "description": "The unique ID of the task."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the \"Momentum Tasks\" application, focusing on user authentication and task management.  The structure leverages path-based ownership for tasks to ensure secure and scalable access. Each user has their own collection of tasks, providing isolation and efficient querying.\n\n*   **Authorization Independence:** The design achieves authorization independence by storing tasks as subcollections of users (`/users/{userId}/tasks/{taskId}`).  This eliminates the need for `get()` calls in security rules to validate ownership, as the path itself establishes the relationship between the user and their tasks.  No data needs to be denormalized because the path inherently provides the necessary authorization context. This ensures atomic operations are possible and rules are simple and easy to debug.\n*   **QAPs:** The structure supports secure `list` operations by using hierarchical paths (`/users/{userId}/tasks`). Security rules can efficiently filter tasks based on the `userId` in the path, preventing unauthorized access to other users' tasks. Because of structural segregation, all documents in the `/users/{userId}/tasks` collection share the same security requirements and there is no need to filter."
  }
}